<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{
  margin:0;
  font-family:'Inter',sans-serif;
  user-select:none;
  overflow:hidden;
}

canvas{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  z-index:0;
}

.content{
  position:relative;
  z-index:1;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  padding-left:10vw;
  padding-top:12vh;
  color:#111;
}

h1{
  font-size:2.6rem;
  font-weight:500;
  margin:0;
}

.subtitle{
  margin-top:10px;
  font-weight:400;
  font-size:1rem;
}

.section{
  margin-top:60px;
  font-size:0.8rem;
}

.item{
  margin-top:14px;
  font-size:1rem;
  text-decoration:none;
  color:#111;
}

.control-btn{
  margin-top:40px;
  font-size:0.75rem;
  background:none;
  border:none;
  cursor:pointer;
  color:#111;
  margin-right:20px;
}

.control-btn:hover{
  opacity:0.6;
}

@media (max-width:768px){
  .content{
    padding-top:8vh;
    padding-left:5vw;
  }
  h1{ font-size:3rem; }
  .subtitle{ font-size:1.2rem; }
  .section{ font-size:1rem; }
  .item{ font-size:1.2rem; margin-top:18px; }
  .control-btn{ font-size:1rem; margin-top:50px; }
}
</style>
</head>
<body>

<canvas id="canvas"></canvas>

<div class="content">
  <h1>kinotamag</h1>
  <div class="subtitle">ðŸ¥šðŸ¥š ðŸ¥š</div>

  <div class="section">WORKS</div>
  <a href="#" class="item">01</a>
  <a href="#" class="item">02</a>

  <div class="section">CONTACT</div>

  <div>
    <button class="control-btn" onclick="saveImage()">FREEZE</button>
    <button class="control-btn" onclick="resetCanvas()">RESET</button>
  </div>
</div>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

function resize(){
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
}
resize();
window.addEventListener("resize",resize);

let mouse={x:canvas.width/2,y:canvas.height/2};
let pen={x:mouse.x,y:mouse.y};
let lastPen={x:pen.x,y:pen.y};
let width=25;

let points=[];
let drawCount=0;
const maxDraw=600;
let isDrawing=false;

/* ã‚¿ãƒƒãƒ & ãƒžã‚¦ã‚¹ */
window.addEventListener("mousemove", e=>{ mouse.x=e.clientX; mouse.y=e.clientY; });
window.addEventListener("mousedown", e=>{ isDrawing=true; mouse.x=e.clientX; mouse.y=e.clientY; pen.x=mouse.x; pen.y=mouse.y; lastPen.x=pen.x; lastPen.y=pen.y; });
window.addEventListener("mouseup", e=>{ isDrawing=false; });

window.addEventListener("touchstart", e=>{
  if(e.touches.length===1){
    isDrawing=true;
    mouse.x=e.touches[0].clientX;
    mouse.y=e.touches[0].clientY;
    pen.x=mouse.x;
    pen.y=mouse.y;
    lastPen.x=pen.x;
    lastPen.y=pen.y;
  } else isDrawing=false;
});

window.addEventListener("touchmove", e=>{
  if(e.touches.length===1 && isDrawing){
    mouse.x=e.touches[0].clientX;
    mouse.y=e.touches[0].clientY;
  }
  e.preventDefault();
},{passive:false});

window.addEventListener("touchend", e=>{ if(e.touches.length===0) isDrawing=false; });

/* è£œé–“ */
function interpolate(p0,p1,seg){
  const arr=[];
  for(let i=0;i<seg;i++){
    const t=i/seg;
    arr.push({x:p0.x+(p1.x-p0.x)*t, y:p0.y+(p1.y-p0.y)*t});
  }
  return arr;
}

/* æç”»ãƒ«ãƒ¼ãƒ— */
function draw(){
  if(isDrawing){
    const ease=0.3;
    pen.x += (mouse.x-pen.x)*ease;
    pen.y += (mouse.y-pen.y)*ease;

    const dx=pen.x-lastPen.x;
    const dy=pen.y-lastPen.y;
    const speed=Math.sqrt(dx*dx+dy*dy);

    let targetWidth=25-Math.pow(speed*1.3,0.85);

    // PCã¯ç­†åœ§çš„ã«å¼·ã„ã¨ã‚‚ã£ã¨å¤ªã
    if(window.innerWidth>768) targetWidth*=1.2;

    if(targetWidth<0.5) targetWidth=0.5;
    width+=(targetWidth-width)*0.2;

    points.push({x:pen.x,y:pen.y,w:width});
    if(points.length>8) points.shift();

    if(points.length>=2){
      for(let i=0;i<points.length-1;i++){
        const p0=points[i];
        const p1=points[i+1];
        const interp=interpolate(p0,p1,4);
        interp.forEach((pt,idx)=>{
          const next=interp[idx+1]||p1;
          ctx.beginPath();
          ctx.moveTo(pt.x,pt.y);
          ctx.lineTo(next.x,next.y);
          const w=p0.w*(1-i/points.length*0.6);
          ctx.lineWidth=w;
          const shade=Math.floor(Math.random()*12);
          ctx.strokeStyle=`rgb(${shade},${shade},${shade})`;
          ctx.lineCap="round";
          ctx.stroke();
          drawCount++;
        });
      }
    }

    if(drawCount>maxDraw){
      ctx.fillStyle="rgba(255,255,255,0.008)";
      ctx.fillRect(0,0,canvas.width,canvas.height);
    }
  }

  lastPen.x=pen.x;
  lastPen.y=pen.y;
  requestAnimationFrame(draw);
}
draw();

/* RESET */
function resetCanvas(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawCount=0;
  points=[];
}

/* FREEZE - æç”»ç¯„å›²ã®ã¿ã‚­ãƒ£ãƒ—ãƒãƒ£ */
function saveImage(){
  if(points.length===0) return;
  // æç”»ç¯„å›²å–å¾—
  let minX=canvas.width, minY=canvas.height, maxX=0, maxY=0;
  points.forEach(p=>{
    if(p.x<minX) minX=p.x;
    if(p.y<minY) minY=p.y;
    if(p.x>maxX) maxX=p.x;
    if(p.y>maxY) maxY=p.y;
  });
  const padding=20; // å°‘ã—ä½™ç™½
  minX=Math.max(0,minX-padding);
  minY=Math.max(0,minY-padding);
  maxX=Math.min(canvas.width,maxX+padding);
  maxY=Math.min(canvas.height,maxY+padding);
  const w=maxX-minX;
  const h=maxY-minY;

  html2canvas(canvas, {width:w, height:h, x:minX, y:minY}).then(c=>{
    const link=document.createElement("a");
    link.download="trail.png";
    link.href=c.toDataURL();
    link.click();
  });
}
</script>

</body>
</html>












