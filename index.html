<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{
  margin:0;
  font-family:'Inter',sans-serif;
  user-select:none;
  -webkit-user-select:none;
  -moz-user-select:none;
  -ms-user-select:none;
  overflow-y:hidden; /* PCã¯ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãªã— */
}

canvas{
  position:absolute;
  top:0;
  left:0;
  z-index:0;
}

.content{
  position:relative;
  z-index:1;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  padding-left:10vw;
  padding-top:15vh;
  color:#111;
}

h1{
  font-size:2.6rem;
  font-weight:500;
  margin:0;
}

.subtitle{
  margin-top:10px;
  font-weight:400;
  font-size:1rem;
}

.section{
  margin-top:60px;
  font-size:0.8rem;
}

.item{
  margin-top:14px;
  font-size:1rem;
  text-decoration:none;
  color:#111;
}

.control-btn{
  margin-top:40px;
  font-size:0.75rem;
  background:none;
  border:none;
  cursor:pointer;
  color:#111;
  margin-right:20px;
}

.control-btn:hover{
  opacity:0.6;
}

/* ã‚¹ãƒãƒ›ç”¨ */
@media (max-width:768px){
  body {
    overflow-y:auto; /* ã‚¹ãƒãƒ›ã ã‘ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ */
  }
  .content{
    padding-top:18vh;
    padding-left:5vw;
  }
  h1{ font-size:3rem; }
  .subtitle{ font-size:1.2rem; }
  .section{ font-size:1rem; }
  .item{ font-size:1.2rem; margin-top:18px; }
  .control-btn{ font-size:1rem; margin-top:50px; }

  /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é ˜åŸŸã‚’ä¸‹ã«ç¢ºä¿ */
  body::after{
    content:'';
    display:block;
    height:800px; /* ä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãã‚‹é ˜åŸŸ */
  }
}
</style>
</head>
<body>

<canvas id="canvas"></canvas>

<div class="content">
  <h1>kinotamag</h1>
  <div class="subtitle">ğŸ¥šğŸ¥š ğŸ¥š</div>

  <div class="section">WORKS</div>
  <a href="#" class="item">01</a>
  <a href="#" class="item">02</a>

  <div class="section">CONTACT</div>

  <div>
    <button class="control-btn" onclick="saveImage()">FREEZE</button>
    <button class="control-btn" onclick="resetCanvas()">RESET</button>
  </div>
</div>

<script>
/* ===== ä¿å­˜ ===== */
function saveImage(){
  html2canvas(document.body).then(canvasImage=>{
    const link=document.createElement("a");
    link.download="trail.png";
    link.href=canvasImage.toDataURL();
    link.click();
  });
}

/* ===== ãƒªã‚»ãƒƒãƒˆ ===== */
function resetCanvas(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawCount=0;
  points=[];
}

/* ===== canvas åˆæœŸåŒ– ===== */
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  if(window.innerWidth <= 768){
    canvas.height = document.body.scrollHeight; // ã‚¹ãƒãƒ›ã¯ãƒšãƒ¼ã‚¸å…¨ä½“
  } else {
    canvas.height = window.innerHeight; // PCã¯1ç”»é¢ã®ã¿
  }
}
resize();
window.addEventListener("resize",resize);

/* ===== æç”»ãƒ‡ãƒ¼ã‚¿ ===== */
let mouse={x:canvas.width/2,y:canvas.height/2};
let pen={x:mouse.x, y:mouse.y};
let lastPen={x:pen.x, y:pen.y};

const ease=0.22;
const maxWidth=25;
const minWidth=0.5;
let width=maxWidth;

let points=[];
let drawCount=0;
const maxDraw=600; // è“„ç©é‡ã®ä¸Šé™

/* ===== è£œé–“é–¢æ•° ===== */
function interpolatePoints(p0,p1,segments){
  const arr=[];
  for(let i=0;i<segments;i++){
    const t=i/segments;
    arr.push({x:p0.x+(p1.x-p0.x)*t, y:p0.y+(p1.y-p0.y)*t});
  }
  return arr;
}

/* ===== æç”»åˆ¶å¾¡ ===== */
let isDrawing=false;

/* ãƒã‚¦ã‚¹ */
window.addEventListener("mousemove", e=>{
  mouse.x=e.clientX;
  mouse.y=e.clientY + window.scrollY; // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«è£œæ­£
});

/* ã‚¿ãƒƒãƒ */
window.addEventListener("touchstart", e=>{
  if(e.touches.length===1){
    isDrawing=true;
    mouse.x=e.touches[0].clientX;
    mouse.y=e.touches[0].clientY + window.scrollY;
    pen.x=mouse.x;
    pen.y=mouse.y;
    lastPen.x=mouse.x;
    lastPen.y=mouse.y;
  } else {
    isDrawing=false; // 2æœ¬æŒ‡ä»¥ä¸Šã¯æç”»ã›ãšã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½
  }
});

window.addEventListener("touchmove", e=>{
  if(e.touches.length===1 && isDrawing){
    mouse.x=e.touches[0].clientX;
    mouse.y=e.touches[0].clientY + window.scrollY;
    e.preventDefault(); // 1æœ¬æŒ‡æç”»æ™‚ã®ã¿ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åœæ­¢
  }
});

window.addEventListener("touchend", e=>{
  if(e.touches.length===0) isDrawing=false;
});

/* ===== æç”»ãƒ«ãƒ¼ãƒ— ===== */
function draw(){
  // penè¿½å¾“
  pen.x += (mouse.x - pen.x) * ease;
  pen.y += (mouse.y - pen.y) * ease;

  const dx = pen.x - lastPen.x;
  const dy = pen.y - lastPen.y;
  const speed = Math.sqrt(dx*dx + dy*dy);

  // å¤ªã•ã¯é€Ÿåº¦ã«å¿œã˜ã¦
  let targetWidth=maxWidth-Math.pow(speed*1.3,0.85);
  if(targetWidth<minWidth) targetWidth=minWidth;
  width += (targetWidth - width)*0.2;

  points.push({x:pen.x,y:pen.y,w:width});
  if(points.length>10) points.shift();

  if(points.length>=2){
    for(let i=0;i<points.length-1;i++){
      const p0=points[i];
      const p1=points[i+1];

      const interp=interpolatePoints(p0,p1,3);
      interp.forEach((pt,idx)=>{
        const next = interp[idx+1] || p1;
        ctx.beginPath();
        ctx.moveTo(pt.x,pt.y);
        ctx.lineTo(next.x,next.y);

        // å¢¨æ„Ÿãƒ»ç­†åœ§
        const w = p0.w*(1-i/points.length*0.6);
        ctx.lineWidth=w;

        const shade = Math.floor(Math.random()*20); // å¢¨ã£ã½ã•
        ctx.strokeStyle=`rgb(${shade},${shade},${shade})`;

        ctx.lineCap="round";
        ctx.stroke();

        drawCount++;
      });
    }
  }

  // è“„ç©é‡ã«å¿œã˜ã¦å°‘ã—ãšã¤è–„ã
  if(drawCount>maxDraw){
    ctx.fillStyle="rgba(255,255,255,0.008)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
  }

  lastPen.x=pen.x;
  lastPen.y=pen.y;

  requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>






