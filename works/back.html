<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Real 3D Back Buttons</title>
<style>
html,body{
  margin:0;
  overflow:hidden;
  background:#111;
  font-family:sans-serif;
}
#ui{
  position:fixed;
  top:30px;
  width:100%;
  text-align:center;
  color:white;
  pointer-events:none;
}
#ui h1{
  margin:0;
  font-size:42px;
  letter-spacing:2px;
}
#ui p{
  margin:8px 0 0;
  font-size:18px;
  opacity:0.8;
}
</style>
</head>
<body>

<div id="ui">
  <h1>戻る / Back</h1>
  <p>どれか押すと戻ります</p>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

<script>
let scene=new THREE.Scene();
scene.background=new THREE.Color(0x111111);

let camera=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,0.1,100);
camera.position.set(0,2,18);

let renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio,1.5));
renderer.shadowMap.enabled=true;
document.body.appendChild(renderer.domElement);

/* Lighting */
scene.add(new THREE.AmbientLight(0xffffff,0.4));

let light=new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,10,10);
light.castShadow=true;
scene.add(light);

/* Floor */
let floor=new THREE.Mesh(
  new THREE.PlaneGeometry(50,50),
  new THREE.MeshStandardMaterial({color:0x222222})
);
floor.rotation.x=-Math.PI/2;
floor.position.y=-5;
floor.receiveShadow=true;
scene.add(floor);

/* Button creator */
function createRealButton(type,x){
  const group=new THREE.Group();

  const baseMat=new THREE.MeshStandardMaterial({
    color:0x888888,
    metalness:0.6,
    roughness:0.3
  });

  const topMat=new THREE.MeshStandardMaterial({
    color:0xcc0000,
    metalness:0.2,
    roughness:0.4
  });

  // ベース（土台）
  let base=new THREE.Mesh(
    new THREE.CylinderGeometry(2.2,2.2,0.6,32),
    baseMat
  );
  base.castShadow=true;
  base.receiveShadow=true;
  group.add(base);

  let top;

  if(type==="round"){
    top=new THREE.Mesh(
      new THREE.CylinderGeometry(1.6,1.6,0.8,32),
      topMat
    );
  }
  if(type==="square"){
    top=new THREE.Mesh(
      new THREE.BoxGeometry(3,1,3),
      topMat
    );
  }
  if(type==="arcade"){
    top=new THREE.Mesh(
      new THREE.SphereGeometry(1.5,32,32,0,Math.PI*2,0,Math.PI/2),
      topMat
    );
  }

  top.position.y=0.7;
  top.castShadow=true;
  group.add(top);

  group.position.set(x,0,0);
  group.userData={
    pressed:false,
    top:top,
    velocity:0
  };

  scene.add(group);
  return group;
}

let buttons=[];
buttons.push(createRealButton("round",-6));
buttons.push(createRealButton("square",0));
buttons.push(createRealButton("arcade",6));

/* Animation */
function animate(){
  requestAnimationFrame(animate);

  buttons.forEach(b=>{
    if(b.userData.pressed){
      b.userData.velocity+=0.02;
      b.userData.top.position.y-=b.userData.velocity;
      if(b.userData.top.position.y<0.2){
        setTimeout(()=>{
          window.location.href="index.html";
        },150);
      }
    }
  });

  renderer.render(scene,camera);
}
animate();

/* Interaction */
let ray=new THREE.Raycaster();
let mouse=new THREE.Vector2();

window.addEventListener("pointerdown",e=>{
  mouse.x=(e.clientX/window.innerWidth)*2-1;
  mouse.y=-(e.clientY/window.innerHeight)*2+1;
  ray.setFromCamera(mouse,camera);
  let hits=ray.intersectObjects(scene.children,true);
  if(hits.length){
    let obj=hits[0].object;
    buttons.forEach(b=>{
      if(obj===b.userData.top){
        b.userData.pressed=true;
        if(navigator.vibrate) navigator.vibrate(15);
      }
    });
  }
});

/* Resize */
window.addEventListener("resize",()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>
